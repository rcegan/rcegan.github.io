<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>rcegan.xyz/posts/attempted-uac-bypass-via-iscsicpl.exe-sentinel-detection/</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><link rel=stylesheet href=https://rcegan.xyz/hugo-theme-console/css/terminal-0.7.2.min.css><link rel=stylesheet href=https://rcegan.xyz/hugo-theme-console/css/animate-4.1.1.min.css><link rel=stylesheet href=https://rcegan.xyz/hugo-theme-console/css/console.css><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><meta property="og:title" content="'Attempted UAC Bypass via iscsicpl.exe' Sentinel detection"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://rcegan.xyz/posts/attempted-uac-bypass-via-iscsicpl.exe-sentinel-detection/"><meta property="article:published_time" content="2022-07-20T00:00:00+00:00"><meta name=twitter:title content="'Attempted UAC Bypass via iscsicpl.exe' Sentinel detection"><meta name=twitter:description content="The UAC Bypass I was tipped off to the UAC bypass by this post from Will Dormann. I quickly found another tweet by @nas_bench with a Sigma rule to detect it. I jumped on Uncoder and generated the below query:
DeviceImageLoadEvents | where (InitiatingProcessFolderPath =~ @&#34;C:\Windows\SysWOW64\iscsicpl.exe&#34; and not (FolderPath contains @&#34;C:\Windows\&#34; and FolderPath contains &#34;iscsiexe.dll&#34;)) I&rsquo;ve created a KQL file with entity mappings on my github."></head><body class=terminal><div class=container><div class=terminal-nav><header class=terminal-logo><div class="logo terminal-prompt"><a href=https://rcegan.xyz/ class="no-style site-name">rcegan.xyz</a>:~#
<a href=https://rcegan.xyz/posts>posts</a>/<a href=https://rcegan.xyz/posts/attempted-uac-bypass-via-iscsicpl.exe-sentinel-detection>attempted-uac-bypass-via-iscsicpl.exe-sentinel-detection</a>/</div></header><nav class=terminal-menu><ul vocab="https://schema.org/" typeof="BreadcrumbList"><li><a href=https://rcegan.xyz/about/ typeof="ListItem">about</a></li><li><a href=https://rcegan.xyz/posts/ typeof="ListItem">posts</a></li><li><a href=https://rcegan.xyz/projects/ typeof="ListItem">projects</a></li><li><a href=https://twitter.com/GarrysSketch typeof="ListItem">twitter</a></li></ul></nav></div></div><div class="container animated zoomIn fast"><h1>'Attempted UAC Bypass via iscsicpl.exe' Sentinel detection</h1>Jul. 20, 2022<br><br><h1 id=the-uac-bypass>The UAC Bypass</h1><p>I was tipped off to the UAC bypass by <a href=https://twitter.com/wdormann/status/1547583317410607110>this</a> post from Will Dormann. I quickly found <a href=https://twitter.com/nas_bench/status/1549417732910768132>another tweet</a> by @nas_bench with a Sigma rule to detect it. I jumped on Uncoder and generated the below query:</p><pre tabindex=0><code>DeviceImageLoadEvents 
| where (InitiatingProcessFolderPath =~ @&#34;C:\Windows\SysWOW64\iscsicpl.exe&#34; and not (FolderPath contains @&#34;C:\Windows\&#34; and FolderPath contains &#34;iscsiexe.dll&#34;))
</code></pre><p>I&rsquo;ve created a KQL file with entity mappings on my <a href=https://github.com/rcegan/KQL-Tomfoolery/blob/main/Image%20Load/Attempt%20to%20bypass%20UAC%20via%20iscsicpl.exe.kql>github</a>.</p><div class=footer>Powered by <a href=https://gohugo.io/>Hugo</a> with
<a href=https://github.com/mrmierzejewski/hugo-theme-console/>Console Theme</a>.</div></div></body></html>